# 编译大作业第二部分报告

## 1. 设计思路

主要的设计思路是先进行字符串分析将字符串转化为IR结构，之后再将IR结构输出。

## 2. 实现方法

#### 树结构

树结构沿用了IR的定义，在IR的基础上进行了修改。

#### 循环变量范围推断

由于循环变量的范围无法直接确定，我们使用了$fix$函数来确定每个变量的范围。

主要采用分治递归的方式，将表达式中的所有数值取出并根据这些数值求出每个变量的范围。

表达式分析时最先分析括号，之后分析加减运算，再之后分析乘除模运算，最后分析变量和常数的情况。

#### 建树部分

建树部分使用了分治算法对字符串进行分析。

用$build\_exp$函数来构造一个$exp$对应的结点。

对于赋值语句，我们会新建一个临时变量将该语句保存下来，在计算完后再将该临时变量的值传给被赋值的变量。

#### 输出部分

输出部分主要沿用了IRPrinter的代码，在其基础上做了一些修改。

## 3. 组内分工

四人共同讨论大作业思路并进行分工。

黄致焕、冯哲：实现字符串分析代码以及修改原IR结构代码。

杨芳源：实现输入输出代码。

姜成烨：构造测试数据并修复程序潜在bug。